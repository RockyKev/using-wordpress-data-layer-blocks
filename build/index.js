(()=>{"use strict";const e=window.wp.element,t=window.wp.components,n=window.wp.data,a=window.wp.coreData,r=window.wp.htmlEntities,s=window.wp.notices;function l(){const[r,s]=(0,e.useState)(""),{pages:l,hasResolved:i}=(0,n.useSelect)((e=>{const t={};r&&(t.search=r);const n=["postType","page",t];return{pages:e(a.store).getEntityRecords(...n),hasResolved:e(a.store).hasFinishedResolution("getEntityRecords",n)}}),[r]);return(0,e.createElement)("div",null,(0,e.createElement)(o,null),(0,e.createElement)("div",{className:"list-controls"},(0,e.createElement)(t.SearchControl,{onChange:s,value:r}),(0,e.createElement)(c,null)),(0,e.createElement)(u,{hasResolved:i,pages:l}))}function o(){const a=(0,n.useSelect)((e=>e(s.store).getNotices()),[]),{removeNotice:r}=(0,n.useDispatch)(s.store),l=a.filter((e=>{let{type:t}=e;return"snackbar"===t}));return(0,e.createElement)(t.SnackbarList,{notices:l,className:"components-editor-notices_snackbar",onRemove:r})}const i=r=>{let{pageId:l}=r;const{createSuccessNotice:o,createErrorNotice:i}=(0,n.useDispatch)(s.store),{getLastEntityDeleteError:c}=(0,n.useSelect)(a.store),{deleteEntityRecord:d}=(0,n.useDispatch)(a.store),{isDeleting:p}=(0,n.useSelect)((e=>({isDeleting:e(a.store).isDeletingEntityRecord("postType","page",l)})),[l]);return(0,e.createElement)(t.Button,{variant:"primary",onClick:async()=>{if(await d("postType","page",l))o("The page was deleted",{type:"snackbar"});else{const e=c("postType","page",l);i((e?.message||"There was an error")+" Please refresh the page and try again.",{type:"snackbar"})}},disabled:p},p?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Spinner,null),"Dleting..."):"Delete")};function c(){const[n,a]=(0,e.useState)(!1),r=()=>a(!1);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Button,{onClick:()=>a(!0),variant:"primary"},"Create a New Page"),n&&(0,e.createElement)(t.Modal,{onRequestClose:r,title:"Create a new page"},(0,e.createElement)(d,{onCancel:r,onSaveFinished:r})))}function d(t){let{onSaveFinished:r,onCancel:s}=t;const[l,o]=(0,e.useState)(),{lastError:i,isSaving:c}=(0,n.useSelect)((e=>({lastError:e(a.store).getLastEntitySaveError("postType","page"),isSaving:e(a.store).isSavingEntityRecord("postType","page")})),[]),{saveEntityRecord:d}=(0,n.useDispatch)(a.store);return(0,e.createElement)(E,{title:l,onChangeTitle:o,hasEdits:!!l,onSave:async()=>{await d("postType","page",{title:l,status:"publish"})&&r()},lastError:i,onCancel:s,isSaving:c})}function p(t){let{pageId:r,onCancel:s,onSaveFinished:l}=t;const{page:o,lastError:i,isSaving:c,hasEdits:d}=(0,n.useSelect)((e=>({page:e(a.store).getEditedEntityRecord("postType","page",r),lastError:e(a.store).getLastEntitySaveError("postType","page",r),isSaving:e(a.store).isSavingEntityRecord("postType","page",r),hasEdits:e(a.store).hasEditsForEntityRecord("postType","page",r)})),[r]),{saveEditedEntityRecord:p,editEntityRecord:m}=(0,n.useDispatch)(a.store);return(0,e.createElement)(E,{title:o.title,onChangeTitle:e=>m("postType","page",r,{title:e}),hasEdits:d,lastError:i,isSaving:c,onCancel:s,onSave:async()=>{await p("postType","page",r)&&l()}})}function E(n){let{title:a,onChangeTitle:r,hasEdits:s,lastError:l,isSaving:o,onCancel:i,onSave:c}=n;return(0,e.createElement)("div",{className:"my-gutenberg-form"},(0,e.createElement)(t.TextControl,{label:"Page title:",value:a,onChange:r}),(0,e.createElement)(e.Fragment,null,!!l&&(0,e.createElement)("div",{className:"form-error"},"Error: ",l.message)),(0,e.createElement)("div",{className:"form-buttons"},(0,e.createElement)(t.Button,{onClick:c,variant:"primary",disabled:!s||o},o?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Spinner,null),"Saving..."):"Save"),(0,e.createElement)(t.Button,{onClick:i,variant:"tertiary"},"Cancel")))}function m(n){let{pageId:a}=n;const[r,s]=(0,e.useState)(!1),l=()=>s(!1);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Button,{onClick:()=>s(!0),variant:"primary"},"Edit"),r&&(0,e.createElement)(t.Modal,{onRequestClose:l,title:"Edit page"},(0,e.createElement)(p,{pageId:a,onCancel:l,onSaveFinished:l})))}function u(n){let{hasResolved:a,pages:s}=n;return a?s?.length?(0,e.createElement)("table",{className:"wp-list-table widefat fixed striped table-view-list"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",null,"Title"),(0,e.createElement)("td",{style:{width:120}},"Actions"))),(0,e.createElement)("tbody",null,s?.map((t=>(0,e.createElement)("tr",{key:t.id},(0,e.createElement)("td",null,(0,r.decodeEntities)(t.title.rendered)),(0,e.createElement)("td",null,(0,e.createElement)("div",{className:"form-buttons rocky"},(0,e.createElement)(m,{pageId:t.id}),(0,e.createElement)(i,{pageId:t.id})))))))):(0,e.createElement)("div",null,"No results"):(0,e.createElement)(t.Spinner,null)}window.addEventListener("load",(()=>{(0,e.render)((0,e.createElement)(l,null),document.querySelector("#my-first-gutenberg-app"))}),!1)})();